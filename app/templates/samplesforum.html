{% extends "base.html" %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block content %}
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h2 class="card-title text-center text-uppercase text-primary mb-4">Submit Your Sample</h2>
                        {{ wtf.quick_form(form, novalidate=true) }}
                    </div>
                </div>
            </div>
            <div class="col-md-8">
                <div class="card mb-4">
                    <div class="card-body">
                        <h3 class="card-title">Filter by Tag</h3>
                        <div class="mb-3">
                            <button class="btn btn-outline-primary tag-filter" data-tag="">All</button>
                            {% for tag in all_tags %}
                                <button class="btn btn-outline-primary tag-filter" data-tag="{{ tag.name }}">{{ tag.name }}</button>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                {% for post in posts %}
                    <div class="card mb-4 post-card" data-tags="{% for tag in post.tags %}{{ tag.name }} {% endfor %}">
                        <div class="card-body">
                            <h3 class="card-title"><a href="{{ url_for('post', post_id=post.id) }}">{{ post.title }}</a></h3>
                            <p class="card-subtitle text-muted">{{ post.author.username }} says:</p>
                            <p class="card-text">{{ post.body }}</p>
                            <hr>
                            <p class="card-text">
                                <strong>Tags:</strong>
                                {% for tag in post.tags %}
                                    <span class="badge badge-primary mr-2">{{ tag.name }}</span>
                                {% endfor %}
                            </p>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tagButtons = document.querySelectorAll('.tag-filter');
            const postCards = document.querySelectorAll('.post-card');

            tagButtons.forEach(function(button) {
                button.addEventListener('click', function() {
                    const selectedTag = button.getAttribute('data-tag');
                    filterPosts(selectedTag);
                });
            });

            function filterPosts(tag) {
                postCards.forEach(function(card) {
                    const cardTags = card.getAttribute('data-tags');
                    if (tag === '' || cardTags.includes(tag)) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                });
            }
        });
    </script>

    <style>
        /* Add custom styles here */
        .card {
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 2rem;
            color: #007bff;
        }

        .card-subtitle {
            font-size: 1rem;
        }

        .card-text {
            font-size: 1.2rem;
        }

        .badge {
            font-size: 0.9rem;
        }

        .tag-filter {
            margin-right: 10px;
        }

        /* Add more styles as needed */
    </style>
{% endblock %}

